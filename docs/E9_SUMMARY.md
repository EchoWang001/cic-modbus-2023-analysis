# E9 误判分析实验总结

> 执行时间: 2026-01-22 15:13:16

## 实验目的

深入分析简单规则和ML模型的误判样本，解释性能差异的来源。

---

## E9.1 简单规则 FP 分析

### 关键数据
| 指标 | 数值 |
|------|------|
| FP 总数 | 532 |
| 主要来源场景 | benign (532, 100.0%) |
| FP cwm 均值 | 1.95 |
| TP cwm 均值 | 37.01 |

### 发现
1. FP 主要来自 **benign** 场景的正常运维操作
2. FP 样本的 cwm 值显著低于 Attack 样本
3. 简单规则无法区分正常运维中的连续写操作和攻击行为

---

## E9.2 ML 模型误判分析

### Random Forest
| 指标 | 数值 |
|------|------|
| FN (漏检) | 21 |
| FP (误报) | 185 |
| FN 预测概率均值 | 0.3874 |
| FP 纠正数量 | 347 |
| FP 纠正率 | 65.2% |

### 发现
1. FN 样本的预测概率接近决策边界 (0.5)
2. ML 学习了更复杂的特征组合来区分 Normal 和 Attack
3. 代价是引入了部分漏检 (21 个)

---

## E9.3 规则 vs ML 对比

### 混淆矩阵对比
| 方法 | TP | FN | FP | TN | Precision | Recall | F1 |
|------|----|----|----|----|-----------|--------|----|
| 简单规则 | 1112 | 0 | 532 | 18116 | 0.6764 | 1.0000 | 0.8070 |
| RF | 1091 | 21 | 185 | 18463 | 0.8550 | 0.9811 | 0.9137 |

### 核心权衡
- **简单规则**: 零漏检 (Recall=100%)，但误报较多
- **ML方法**: 大幅减少误报，但引入少量漏检

### 应用建议
| 场景 | 推荐方法 | 理由 |
|------|----------|------|
| 关键基础设施 | 简单规则 | 不能容忍任何漏检 |
| 一般监控 | ML (XGBoost) | 平衡检测率和误报率 |
| 高精度需求 | ML + 人工复核 | 减少误报节省人力 |

---

## 输出文件

### 表格
- `phase3.5_e9_rule_fp_analysis.csv` - 规则 FP 分析
- `phase3.5_e9_ml_fn_analysis.csv` - ML FN 分析
- `phase3.5_e9_error_comparison.csv` - 综合对比

### 图表
- `phase3.5_e9_fp_analysis.png` - FP 样本分析
- `phase3.5_e9_ml_error_analysis.png` - ML 误判分析
- `phase3.5_e9_error_comparison.png` - 误判对比
